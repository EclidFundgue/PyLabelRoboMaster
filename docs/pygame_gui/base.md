

# Base

`Base` 类是 `pygame_gui` 模块的核心元素之一，这个类

1. 是所有自定义 GUI 元素的父类
2. 保存 GUI 元素的相对位置和大小
3. 提供鼠标、键盘响应接口
4. 提供了增加、删除子元素的接口
5. 规范了 GUI 元素的更新、渲染、生存周期管理方式



## 术语

- ***GUI 元素***：`Base` 子类的实例对象
- ***控制范围***：每个 GUI 元素都保存自己的宽（w）、高（h）、横坐标（x）、纵坐标（y）信息， 由这一组信息构成的矩形 `Rect(w,h,x,y)` 就是该 GUI 元素的控制范围。控制范围框定了 GUI 元素的渲染范围和交互范围。
- ***子元素***：GUI 元素的孩子元素



## 代码规范

 基本规范见 [CodeStyle](../CodeStyle.md)



### 方法声明顺序

由于涉及的函数较多，`Base` 中的方法按功能分成几个模块，模块顺序如下：

1. **特殊方法（Special Methods）**：统一声明 Python 的特殊方法，如 `__init__`，`__repr__` 等
2. **自定义方法（Custom Methods）**：如果子类需要扩展新的方法，将方法定义在这里
3. **鼠标事件响应（Mouse Events）**
4. **键盘事件响应（Keyboard Events）**
5. **子元素管理（Child Management）**
6. **更新（Update）**
7. **渲染（Draw）**
8. **生存周期管理（Kill）**



模块内的方法可以按照**字母**排序，也可以按照**功能**排序。在  `Base` 类中，模块内的方法是按照按照**功能**排序的。



## 模块设计说明

### 1.特殊方法

#### `__init__(w,h,x,y)`

- **参数**：
  - `w: int`：元素宽度
  - `h: int`：元素高度
  - `x: int`：元素相在其父元素上的 X 坐标
  - `y: int`：元素相在其父元素上的 Y 坐标

- **返回值**：无



#### `__repr__()`

- **参数**：无

- **返回值**：

  `str`： 包含对象类名、大小、位置



### 2.鼠标事件

#### `onLeftClick(x, y)`

- **描述**：

  当鼠标左键点击时被调用

- **参数**：

  - `x: int`：鼠标点击的 X 坐标
  - `y: int`：鼠标点击的 Y 坐标

- **返回值**：无



#### `onMidClick(x, y)`

- **描述**：

  当鼠标中键点击时被调用

- **参数**：

  - `x: int`：鼠标点击的 X 坐标
  - `y: int`：鼠标点击的 Y 坐标

- **返回值**：无



#### `onRightClick(x, y)`

- **描述**：

  当鼠标右键点击时被调用

- **参数**：

  - `x: int`：鼠标点击的 X 坐标
  - `y: int`：鼠标点击的 Y 坐标

- **返回值**：无



#### `onLeftPress(x, y)`

- **描述**：

  当鼠标左键按下时被调用，如果鼠标一直处于按下状态，则每一帧都调用

- **参数**：

  - `x: int`：鼠标的 X 坐标
  - `y: int`：鼠标的 Y 坐标

- **返回值**：无



#### `onMidPress(x, y)`

- **描述**：

  当鼠标中键按下时被调用，如果鼠标一直处于按下状态，则每一帧都调用

- **参数**：

  - `x: int`：鼠标的 X 坐标
  - `y: int`：鼠标的 Y 坐标

- **返回值**：无



#### `onRightPress(x, y)`

- **描述**：

  当鼠标右键按下时被调用，如果鼠标一直处于按下状态，则每一帧都调用

- **参数**：

  - `x: int`：鼠标的 X 坐标
  - `y: int`：鼠标的 Y 坐标

- **返回值**：无



#### `onLeftDrag(vx, vy)`

- **描述**：

  当鼠标右键按下时被调用，如果鼠标一直处于按下状态，则每一帧都调用

- **参数**：

  - `vx: int`：鼠标的 X 方向相对于上一帧的位移，可能为 0
  - `vy: int`：鼠标的 Y 方向相对于上一帧的位移，可能为 0

- **返回值**：无



#### `onMidDrag(vx, vy)`

- **描述**：

  当鼠标中键按下时被调用，如果鼠标一直处于按下状态，则每一帧都调用

- **参数**：

  - `vx: int`：鼠标的 X 方向相对于上一帧的位移，可能为 0
  - `vy: int`：鼠标的 Y 方向相对于上一帧的位移，可能为 0

- **返回值**：无



#### `onRightDrag(vx, vy)`

- **描述**：

  当鼠标右键按下时被调用，如果鼠标一直处于按下状态，则每一帧都调用

- **参数**：

  - `vx: int`：鼠标的 X 方向相对于上一帧的位移，可能为 0
  - `vy: int`：鼠标的 Y 方向相对于上一帧的位移，可能为 0

- **返回值**：无



#### `onLeftRelease()`

- **描述**：

  当鼠标左键松开时被调用

- **参数**：无

- **返回值**：无



#### `onMidRelease()`

- **描述**：

  当鼠标中键松开时被调用

- **参数**：无

- **返回值**：无



#### `onRightRelease()`

- **描述**：

  当鼠标右键松开时被调用

- **参数**：无

- **返回值**：无



#### `onMouseEnter()`

- **描述**：

  当鼠标进入 GUI 元素控制范围时被调用

- **参数**：无

- **返回值**：无



#### `onMouseLeave()`

- **描述**：

  当鼠标离开 GUI 元素控制范围时被调用

- **参数**：无

- **返回值**：无



### 3.键盘事件

#### `addKeyDownEvent(key, func, target, once)`

- **描述**：

  添加键盘事件，按键按下时被调用

- **参数**：

  - `key: int`：键盘按键，可以是 `pygame.K_xxx`
  - `func: Callable`：事件发生时被调用的函数
  - `target: Hashable = None`：目标组，可在一个 GUI 元素中设置多个不同的目标组，删除事件时按照目标组删除
  - `once: bool = False`：是否是一次性事件，即触发一次后事件被删除

- **返回值**：无



#### `addKeyPressEvent(key, func, target, once)`

- **描述**：

  添加键盘事件，如果键盘按键一直处于按下状态，则每一帧都调用

- **参数**：

  - `key: int`：键盘按键，可以是 `pygame.K_xxx`
  - `func: Callable`：事件发生时被调用的函数
  - `target: Hashable = None`：目标组，可在一个 GUI 元素中设置多个不同的目标组，删除事件时按照目标组删除
  - `once: bool = False`：是否是一次性事件，即触发一次后事件被删除

- **返回值**：无



#### `addKeyUpEvent(key, func, target, once)`

- **描述**：

  添加键盘事件，松开按下时被调用

- **参数**：

  - `key: int`：键盘按键，可以是 `pygame.K_xxx`
  - `func: Callable`：事件发生时被调用的函数
  - `target: Hashable = None`：目标组，可在一个 GUI 元素中设置多个不同的目标组，删除事件时按照目标组删除
  - `once: bool = False`：是否是一次性事件，即触发一次后事件被删除

- **返回值**：无



#### `addKeyCtrlEvent(key, func, target, once)`

- **描述**：

  添加键盘事件，按下 **ctrl + 按键** 的组合键时被调用

- **参数**：

  - `key: int`：键盘按键，可以是 `pygame.K_xxx`
  - `func: Callable`：事件发生时被调用的函数
  - `target: Hashable = None`：目标组，可在一个 GUI 元素中设置多个不同的目标组，删除事件时按照目标组删除
  - `once: bool = False`：是否是一次性事件，即触发一次后事件被删除

- **返回值**：无



#### `removeEvents(target)`

- **描述**：

  删除键盘事件

- **参数**：

  - `target: Hashable = None`：目标组

- **返回值**：无



### 4.子元素管理

#### `removeDeadChildren()`

- **描述**：

  移除生命周期结束的子对象，该方法通常不被外部调用，供内部使用

- **参数**：无

- **返回值**：无



#### `addChild(child)`

- **描述**：

  增加子元素

- **参数**：

  - `child: Base`：需要增加的子元素

- **返回值**：无



#### `removeChild(child)`

- **描述**：

  删除子元素

- **参数**：

  - `child: Base`：需要删除的子元素

- **返回值**：无



#### `setChildren(children)`

- **描述**：

  将子元素强制刷新为列表

- **参数**：

  - `children: List[Base]`：需要设置的子元素

- **返回值**：无



### 5.更新

#### `getRect()`

- **描述**：

  获取 GUI 元素的控制范围

- **参数**：无

- **返回值**：

  `Tuple[int, int, int, int]`：(w, h, x, y)



#### `isHovered(x, y)`

- **描述**：

  判断鼠标是否在 GUI 元素控制范围内

- **参数**：

  - `x: int`：鼠标 X 坐标
  - `y: int`：鼠标 Y 坐标

- **返回值**：

  `bool`：鼠标是否在 GUI 元素控制范围内



#### `update(x, y, wheel)`

- **描述**：

  GUI 元素更新函数，每帧都会被调用。如果将元素的 `interactive_when_active` 设置为 `True`，则只有鼠标在元素控制范围内时才会被调用

- **参数**：

  - `x: int`：鼠标 X 坐标
  - `y: int`：鼠标 Y 坐标
  - `wheel: int`：鼠标滚轮滚动的位移

- **返回值**：无



#### `onResize(w, h, x, y)`

- **描述**：

  当窗口尺寸缩放时被调用

- **参数**：

  - `w: int`：缩放后的元素宽度
  - `h: int`：缩放后的元素高度
  - `x: int`：缩放后元素相在其父元素上的 X 坐标
  - `y: int`：缩放后元素相在其父元素上的 Y 坐标

- **返回值**：无



### 6.渲染

#### `redraw()`

- **描述**：

  申请元素重绘

- **参数**：无

- **返回值**：无



#### `draw(surface, x_start, y_start)`

- **描述**：

  当元素需要绘制时被调用。当元素申请重绘，或元素的父对象申请重绘时绘，都会调用该函数

- **参数**：

  - `surface: Surface`：元素控制区域对应的 pygame Surface
  - `x_start: int`：小于等于 0，当且仅当元素控制区域超出边界时小于 0
  - `y_start: int`：小于等于 0，当且仅当元素控制区域超出边界时小于 0

- **返回值**：无



### 7.生存周期

#### `kill()`

- **描述**：

  当元素不再被需要，或父对象不再被需要时，需要手动调用该函数结束元素生命周期，程序关闭时会被调用

- **参数**：无

- **返回值**：无